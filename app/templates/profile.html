{% extends 'theme.html' %}

{% block title %}
الملف الشخصي
{% endblock %}

{% block content %}
<div class="container">
    <h2 class="section-header text-center mb-4">الملف الشخصي</h2>

    {% if profile and profile.user %}
    <div class="user-info mb-4">
        <div class="row">
            <div class="col-md-6">
                <div class="info-card p-3 mb-3 bg-light rounded">
                    <h5><i class="fas fa-user me-2"></i>الإسم بالكامل</h5>
                    <p class="lead">{{ profile.user.fullname }}</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="info-card p-3 mb-3 bg-light rounded">
                    <h5><i class="fas fa-phone me-2"></i>رقم الجوال</h5>
                    <p class="lead">{{ profile.user.phone_number }}</p>
                </div>
            </div>
        </div>
    </div>

    <details class="mb-4">
        <summary class="password-change-summary">تغيير كلمة المرور</summary>
        <div class="profile p-3">
            <form method="POST" action="{{ url_for('auth.change_password') }}" class="password-form">
                <div class="form-group">
                    <div class="row">
                        <div class="col-12 mb-3">
                            <label for="current_password" class="form-label">كلمة السر الحالية</label>
                            <input type="password" name="current_password" id="current_password" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="new_password" class="form-label">كلمة السر الجديدة</label>
                            <input type="password" name="new_password" id="new_password" class="form-control">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="confirm_password" class="form-label">تأكيد كلمة السر</label>
                            <input type="password" name="confirm_password" id="confirm_password" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <button type="submit" name="Save" class="btn btn-primary">تغيير</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </details>
    {% endif %}

    <div class="profile-form-container">
        <h4 class="mb-3">تعديل البيانات الشخصية</h4>
        <form action="{{ url_for('profile.edit_profile') }}" method="post" autocomplete="on" class="profile-form">
            {{ form.csrf_token }}
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.gender.label(class="form-label") }}
                        {{ form.gender(class="form-select") }}
                        {% if form.gender.errors %}
                            {% for error in form.gender.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.age.label(class="form-label") }}
                        {{ form.age(class="form-control") }}
                        {% if form.age.errors %}
                            {% for error in form.age.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.nationality.label(class="form-label") }}
                        {{ form.nationality(class="form-control") }}
                        {% if form.nationality.errors %}
                            {% for error in form.nationality.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.city.label(class="form-label") }}
                        {{ form.city(class="form-control") }}
                        {% if form.city.errors %}
                            {% for error in form.city.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.height.label(class="form-label") }}
                        {{ form.height(class="form-control") }}
                        {% if form.height.errors %}
                            {% for error in form.height.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.weight.label(class="form-label") }}
                        {{ form.weight(class="form-control") }}
                        {% if form.weight.errors %}
                            {% for error in form.weight.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.skin_color.label(class="form-label") }}
                        {{ form.skin_color(class="form-control") }}
                        {% if form.skin_color.errors %}
                            {% for error in form.skin_color.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.employment_status.label(class="form-label") }}
                        {{ form.employment_status(class="form-control") }}
                        {% if form.employment_status.errors %}
                            {% for error in form.employment_status.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.tribe.label(class="form-label") }}
                        {{ form.tribe(class="form-control") }}
                        {% if form.tribe.errors %}
                            {% for error in form.tribe.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        <div class="form-check form-switch">
                            {{ form.smoking.label(class="form-check-label") }}
                            {{ form.smoking(class="form-check-input") }}
                        </div>
                        {% if form.smoking.errors %}
                            {% for error in form.smoking.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.marital_status.label(class="form-label") }}
                        {{ form.marital_status(class="form-control") }}
                        {% if form.marital_status.errors %}
                            {% for error in form.marital_status.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.education.label(class="form-label") }}
                        {{ form.education(class="form-control") }}
                        {% if form.education.errors %}
                            {% for error in form.education.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        {{ form.marriage_type.label(class="form-label") }}
                        {{ form.marriage_type(class="form-control") }}
                        {% if form.marriage_type.errors %}
                            {% for error in form.marriage_type.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        <div class="form-check form-switch">
                            {{ form.another_nationality.label(class="form-check-label") }}
                            {{ form.another_nationality(class="form-check-input") }}
                        </div>
                        {% if form.another_nationality.errors %}
                            {% for error in form.another_nationality.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="form-group mb-3">
                        {{ form.description.label(class="form-label") }}
                        {{ form.description(class="form-control", rows=3) }}
                        {% if form.description.errors %}
                            {% for error in form.description.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="form-group mb-3">
                        {{ form.partner_requirements.label(class="form-label") }}
                        {{ form.partner_requirements(class="form-control", rows=3) }}
                        {% if form.partner_requirements.errors %}
                            {% for error in form.partner_requirements.errors %}
                                <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    {{ form.submit(class="btn btn-primary btn-lg") }}
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}